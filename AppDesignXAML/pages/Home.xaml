<Page x:Class="AppDesignXAML.pages.Home"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      FlowDirection="RightToLeft"
      Title="Home">

    <Grid d:DesignHeight="500" d:DesignWidth="800">

        <!-- BACKGROUND -->
        <Grid.Background>
            <ImageBrush ImageSource="/Images/backgroundColor.jpg"
                        Stretch="UniformToFill"/>
        </Grid.Background>

        <Border Background="#66000000"/>

        <!-- LOGIN -->
        <Button HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="20"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand"
                Click="Login_Click">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="👤" FontSize="18" Foreground="White"/>
                <TextBlock Text=" התחברות"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Foreground="White"/>
            </StackPanel>
        </Button>

        <!-- MAIN LAYOUT -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- HERO TEXT -->
            <StackPanel Grid.Row="0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                <TextBlock Text="הטיול הבא שלך מתחיל כאן"
                           FontSize="38"
                           FontWeight="SemiBold"
                           Foreground="White"/>
                <TextBlock Text="מצא מלונות, דילים וחופשות בקלות"
                           FontSize="16"
                           Foreground="#E5E7EB"
                           Margin="0 10 0 0"/>
            </StackPanel>

            <!-- SEARCH CARD -->
            <Border Grid.Row="1"
                    Width="760"
                    Padding="28"
                    Background="White"
                    CornerRadius="18"
                    BorderBrush="#E5E7EB"
                    BorderThickness="1"
                    HorizontalAlignment="Center"
                    Margin="0 30">

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2.5*"/>
                        <ColumnDefinition Width="2.5*"/>
                        <ColumnDefinition Width="2.5*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- DESTINATION -->
                    <Border x:Name="DestinationBox"
                            CornerRadius="12"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            Padding="14"
                            Margin="0 0 10 0"
                            Cursor="Hand"
                            MouseLeftButtonUp="Destination_Click">
                        <StackPanel>
                            <TextBlock Text="לאן?"
                                       FontSize="13"
                                       Foreground="#6B7280"/>
                            <TextBlock x:Name="SelectedCityText"
                                       Text="בחר יעד"
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       Foreground="#111827"
                                       Margin="0 6 0 0"/>
                        </StackPanel>
                    </Border>

                    <!-- DATES -->
                    <Border x:Name="DatesBox"
                            Grid.Column="1"
                            CornerRadius="12"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            Padding="14"
                            Margin="10 0"
                            Cursor="Hand"
                            MouseLeftButtonUp="Dates_Click">
                        <StackPanel>
                            <TextBlock Text="תאריכים"
                                       FontSize="13"
                                       Foreground="#6B7280"/>
                            <TextBlock x:Name="DatesText"
                                       Text="בחר תאריכים"
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       Foreground="#111827"
                                       Margin="0 6 0 0"/>
                        </StackPanel>
                    </Border>

                    <!-- GUESTS -->
                    <Border x:Name="GuestsBox"
                            Grid.Column="2"
                            CornerRadius="12"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            Padding="14"
                            Margin="10 0"
                            Cursor="Hand"
                            MouseLeftButtonUp="Guests_Click">
                        <StackPanel>
                            <TextBlock Text="נוסעים"
                                       FontSize="13"
                                       Foreground="#6B7280"/>
                            <TextBlock x:Name="GuestsText"
                                       Text="2 מבוגרים · חדר 1"
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       Foreground="#111827"
                                       Margin="0 6 0 0"/>
                        </StackPanel>
                    </Border>

                    <!-- SEARCH BUTTON -->
                    <Button Grid.Column="3"
                            Content="חפש"
                            Width="120"
                            Height="54"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Background="#E11D48"
                            Foreground="White"
                            FontSize="16"
                            FontWeight="SemiBold"
                            BorderThickness="0"
                            Cursor="Hand"
                            Margin="14 0 0 0"
                            Click="Button_Click"/>
                </Grid>
            </Border>

            <!-- CITIES POPUP -->
            <Popup x:Name="CitiesPopup"
                   PlacementTarget="{Binding ElementName=DestinationBox}"
                   Placement="Bottom"
                   StaysOpen="False"
                   AllowsTransparency="True">
                <Border Background="White"
                        Width="260"
                        CornerRadius="14"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        Padding="8">
                    <ListBox x:Name="CitiesList"
                             MouseDoubleClick="CitiesList_DoubleClick">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding CityName}"
                                           Padding="8"
                                           FontSize="14"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
            </Popup>

            <!-- DATES POPUP -->
            <Popup x:Name="DatesPopup"
                   PlacementTarget="{Binding ElementName=DatesBox}"
                   Placement="Bottom"
                   StaysOpen="False"
                   AllowsTransparency="True">
                <Border Background="White"
                        CornerRadius="16"
                        BorderBrush="#D1D5DB"
                        BorderThickness="1"
                        Padding="16"
                        Width="380">
                    <StackPanel>
                        <TextBlock Text="בחר תאריכים"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center"
                                   Margin="0 0 0 10"/>

                        <Calendar x:Name="CalendarRange"
                                  SelectionMode="SingleRange"
                                  materialDesign:CalendarAssist.HeaderBackground="#673AB7"
                                  materialDesign:CalendarAssist.HeaderForeground="White"/>

                        <Button Content="אישור"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Height="40"
                                Margin="0 10 0 0"
                                Background="#2563EB"
                                Foreground="White"
                                FontWeight="SemiBold"
                                BorderThickness="0"
                                Click="DatesConfirm_Click"/>
                    </StackPanel>
                </Border>
            </Popup>

            <!-- GUESTS POPUP -->
            <Popup x:Name="GuestsPopup"
       PlacementTarget="{Binding ElementName=GuestsBox}"
       Placement="Bottom"
       StaysOpen="False"
       AllowsTransparency="True">

                <Border Background="White"
            CornerRadius="16"
            BorderBrush="#D1D5DB"
            BorderThickness="1"
            Padding="16"
            Width="320">

                    <!-- ✅ RESOURCES FIRST -->
                    <Border.Resources>

                        <Style x:Key="CounterButtonStyle"
                   TargetType="Button"
                   BasedOn="{StaticResource MaterialDesignFlatButton}">
                            <Setter Property="Width" Value="36"/>
                            <Setter Property="Height" Value="36"/>
                            <Setter Property="FontSize" Value="18"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Background" Value="#F3F4F6"/>
                            <Setter Property="Foreground" Value="#1F2937"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="materialDesign:ButtonAssist.CornerRadius" Value="18"/>
                        </Style>

                        <Style x:Key="CounterLabelStyle" TargetType="TextBlock">
                            <Setter Property="Width" Value="80"/>
                            <Setter Property="FontSize" Value="16"/>
                            <Setter Property="FontWeight" Value="Medium"/>
                            <Setter Property="Foreground" Value="#1F2937"/>
                        </Style>

                        <Style x:Key="CounterValueStyle" TargetType="TextBlock">
                            <Setter Property="Width" Value="50"/>
                            <Setter Property="TextAlignment" Value="Center"/>
                            <Setter Property="FontSize" Value="18"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Foreground" Value="#111827"/>
                        </Style>

                    </Border.Resources>

                    <!-- ✅ CONTENT -->
                    <StackPanel>

                        <TextBlock Text="בחירת נוסעים וחדרים"
                       FontSize="16"
                       FontWeight="SemiBold"
                       HorizontalAlignment="Center"
                       Margin="0 0 0 16"/>

                        <!-- ADULTS -->
                        <Grid Margin="0 0 0 12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="מבוגרים"
                           Grid.Column="0"
                           Style="{StaticResource CounterLabelStyle}"
                           HorizontalAlignment="Right"/>

                            <StackPanel Orientation="Horizontal" Grid.Column="1">
                                <Button Content="−" Style="{StaticResource CounterButtonStyle}" Click="AdultsMinus_Click"/>
                                <TextBlock x:Name="AdultsText" Text="2" Style="{StaticResource CounterValueStyle}"/>
                                <Button Content="+" Style="{StaticResource CounterButtonStyle}" Click="AdultsPlus_Click"/>
                            </StackPanel>
                        </Grid>

                        <!-- KIDS -->
                        <Grid Margin="0 0 0 12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="ילדים"
                           Grid.Column="0"
                           Style="{StaticResource CounterLabelStyle}"
                           HorizontalAlignment="Right"/>

                            <StackPanel Orientation="Horizontal" Grid.Column="1">
                                <Button Content="−" Style="{StaticResource CounterButtonStyle}" Click="KidsMinus_Click"/>
                                <TextBlock x:Name="KidsText" Text="0" Style="{StaticResource CounterValueStyle}"/>
                                <Button Content="+" Style="{StaticResource CounterButtonStyle}" Click="KidsPlus_Click"/>
                            </StackPanel>
                        </Grid>

                        <!-- ROOMS -->
                        <Grid Margin="0 0 0 20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="חדרים"
                           Grid.Column="0"
                           Style="{StaticResource CounterLabelStyle}"
                           HorizontalAlignment="Right"/>

                            <StackPanel Orientation="Horizontal" Grid.Column="1">
                                <Button Content="−" Style="{StaticResource CounterButtonStyle}" Click="RoomsMinus_Click"/>
                                <TextBlock x:Name="RoomsText" Text="1" Style="{StaticResource CounterValueStyle}"/>
                                <Button Content="+" Style="{StaticResource CounterButtonStyle}" Click="RoomsPlus_Click"/>
                            </StackPanel>
                        </Grid>

                        <Button Content="אישור"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Height="40"
                    Background="#2563EB"
                    Foreground="White"
                    FontWeight="SemiBold"
                    BorderThickness="0"
                    Click="GuestsConfirm_Click"/>

                    </StackPanel>
                </Border>
            </Popup>
        </Grid>
    </Grid>
</Page>
